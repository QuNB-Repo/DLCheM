# Convolutional Neural Network on SMILES Strings Implemented in Torch

This project implements a convolutional neural network (CNN) to scan and 
process 1D SMILES (Simplified Molecular Input Line Entry System) strings, 
aiming to predict molecular properties. The model primarily serves as a tool 
to analyze the latent space of such models based on molecular string 
representations.

---

## Overview

The CNN scans the SMILES sequences using convolutional layers to extract 
patterns and features. These features are used to make predictions on 
molecular properties, such as activity or solubility. While CNNs are useful 
for sequence-based data, the key findings suggest that the latent space 
generated by this model is significantly different from that produced by 
graph-based or transformer models commonly used in chemistry. Thus, this 
approach has limited applicability in comparison to graph neural networks or 
transformer models.

### Key Conclusions:

- **Latent Space**: The latent space extracted from SMILES strings through 
  this CNN model does not closely resemble the latent spaces of graph-based 
  or transformer models in chemistry. The lack of structural representation 
  inherent in SMILES likely limits the model's capacity to capture meaningful 
  molecular interactions.
- **Comparison**: The CNN-based latent space was found to be much less 
  informative compared to those derived from more complex graph-based or 
  transformer models, which directly encode the molecular structure and its 
  interactions.

---

## Input Data

Only one input file is required to run the model:

1. **CSV file**: The CSV file should contain two columns:
   - **Column 1 (X)**: SMILES strings representing molecules.
   - **Column 2 (Y)**: The corresponding molecular properties for each SMILES 
     string (e.g., activity, solubility, etc.).
   - **Column 3**: split value of the datapoint to determine if it belongs in a 
     training or validation dataset (0 - training, 1 - validation)

### Example CSV Format:

smiles, property, split
CCO, 1.23, 0
C1CCCCC1, 0.98, 1


---

## Model Architecture

The model uses a combination of:
- **Embedding layer**: Converts the SMILES string characters into dense 
  vector representations.
- **GRU (Gated Recurrent Unit)**: Captures sequential dependencies in the 
  SMILES string.
- **Convolutional layers**: Scans through the SMILES string to extract 
  feature patterns, followed by batch normalization for stabilizing training.
- **Fully connected layers**: Dense layers are used to make the final 
  molecular property prediction.

---

## Instructions

1. **Data Preparation**: 
   - Ensure your data is in CSV format with the SMILES strings in one column 
     and the molecular property in another.

2. **Training the Model**:
   - The model is fully annotated and will automatically parse the input 
     data, perform the necessary data processing, and train on the dataset.
   - The optimizer and loss functions are preconfigured, but can be adjusted 
     for specific tasks as needed.

3. **Saving Results**:
   - The model will save the best weights (based on validation loss) and 
     output the predictions on the validation dataset.
   - Additionally, the latent vectors for specific molecular features can be 
     extracted for further analysis.

---

## Key Features

- **Embeddings and Latent Space**: The model extracts intermediate embeddings 
  and convolutional outputs, which can be used for further analysis of how 
  molecular features are represented in the latent space.
- **Convolutional Feature Extraction**: The model is designed to scan SMILES 
  sequences using convolutional filters, allowing for the capture of local 
  dependencies in the molecular string.
- **Analysis and Checkpointing**: The model monitors the validation loss and 
  saves the best-performing model weights to prevent overfitting.

---

## Dependencies

To run the project, the following dependencies are required. You can create 
a separate Conda environment and install these packages:

```bash
python 3.7
pip install torch==1.9.0
pip install numpy==1.21.5
pip install pandas==1.1.5
pip install scikit-learn==0.24.2
pip install ipython
pip install ipykernel
